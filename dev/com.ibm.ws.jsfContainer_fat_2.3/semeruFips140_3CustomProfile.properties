# Allowing for open-source Apache.MyFaces and WSOC
# TODO: Revisit usage of SHA1PRNG (SHA-1) and WSOC SHA-1
# SHA1PRNG does not cause test failures due to defaulting to the JDK's SecureRandom (https://github.com/OpenLiberty/open-liberty/blob/integration/dev/com.ibm.ws.jsf.2.2/src/org/apache/myfaces/application/viewstate/SessionIdGenerator.java)
# However exceptions appear in the logs and should be addressed
# WSOC Utils.java uses SHA-1 as configured (https://github.com/OpenLiberty/open-liberty/blob/b6cbb2bd7d8ffaa0aec4c386f73410ca71a2fe0d/dev/com.ibm.ws.wsoc/src/com/ibm/ws/wsoc/util/Utils.java#L469)
# This is a set value, refer to: https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/101
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.desc.name = Custom OpenJCEPlusFIPS Cryptographic Module FIPS 140-3
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.extends = RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.2 = sun.security.provider.Sun [+ \
    {MessageDigest, SHA-1, *, FullClassName:com.ibm.ws.wsoc.util.Utils}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.myfaces.util.token.SessionIdGenerator}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.myfaces.application.viewstate.SessionIdGenerator}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.myfaces.push.cdi.SessionIdGenerator}, \
    {SecureRandom, SHA1PRNG, *, FullClassName:org.apache.myfaces.util.token.SessionIdGenerator}, \
    {SecureRandom, SHA1PRNG, *, FullClassName:org.apache.myfaces.application.viewstate.SessionIdGenerator}, \
    {SecureRandom, SHA1PRNG, *, FullClassName:org.apache.myfaces.push.cdi.SessionIdGenerator}]
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.4 = com.sun.crypto.provider.SunJCE [ \
    {AlgorithmParameters, PBES2, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {AlgorithmParameters, PBEWithHmacSHA256AndAES_256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {SecretKeyFactory, PBEWithMD5AndDES, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {Cipher, PBEWithHmacSHA256AndAES_256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {Mac, HmacPBESHA256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}]