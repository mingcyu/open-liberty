# add constraints to allow for algorithms used in org.apache.wss4j open source library
# add constraints to allow for algorithms used in org.apache.xml.security open source library
# TODO: Revisit this after https://github.com/OpenLiberty/open-liberty/issues/31846 addressed
# TODO: Revisit this after https://github.com/OpenLiberty/open-liberty/issues/31929 addressed
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.desc.name = Custom OpenJCEPlusFIPS Cryptographic Module FIPS 140-3
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.extends = RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.2 = sun.security.provider.Sun [+ \
    {KeyStore, PKCS12, *, ModuleAndFullClassName:java.base/java.security.KeyStore}, \
    {KeyStore, JKS, *, ModuleAndFullClassName:java.base/java.security.KeyStore}, \
    {MessageDigest, SHA-1, *, ModuleAndFullClassName:java.base/java.security.KeyStore}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.message.WSSecSignature}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.common.util.KeyUtils}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.message.WSSecEncryptedKey}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.processor.EncryptedKeyProcessor}, \
    {MessageDigest, SHA-1, *, FullClassName:org.apache.wss4j.dom.processor.SignatureProcessor}, \
    {MessageDigest, SHA-1, *, FullClassName:org.ehcache.impl.persistence.FileUtils}]
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.4 = com.sun.crypto.provider.SunJCE [ \
    {AlgorithmParameters, PBES2, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {Cipher, RSA, *, FullClassName:org.apache.wss4j.common.util.KeyUtils}, \
    {Cipher, AES, *, FullClassName:org.apache.xml.security.encryption.XMLCipher}, \
    {AlgorithmParameters, PBEWithHmacSHA256AndAES_256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {SecretKeyFactory, PBEWithMD5AndDES, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {Cipher, PBEWithHmacSHA256AndAES_256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}, \
    {Mac, HmacPBESHA256, *, ModuleAndFullClassName:java.base/sun.security.pkcs12.PKCS12KeyStore}]
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.5 = org.apache.jcp.xml.dsig.internal.dom.XMLDSigRI 
RestrictedSecurity.OpenJCEPlusFIPS.FIPS140-3-Custom.jce.provider.6 = org.apache.wss4j.dom.transform.STRTransformProvider

